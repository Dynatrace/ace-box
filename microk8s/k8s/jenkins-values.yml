master:
  # Used for label app.kubernetes.io/component
  componentName: "jenkins-master"
  image: "jenkins/jenkins"
  tag: "lts"
  adminPassword: "dynatrace"
  serviceType: "NodePort"
  nodePort: 31000
  containerEnv:
    - name: GITHUB_USER_EMAIL
      value: GITHUB_USER_EMAIL_PLACEHOLDER
    - name: GITHUB_ORGANIZATION
      value: GITHUB_ORGANIZATION_PLACEHOLDER
    - name: GITHUB_USER_NAME
      value: GITHUB_USER_NAME_PLACEHOLDER
    - name: GITHUB_PERSONAL_ACCESS_TOKEN
      value: GITHUB_PERSONAL_ACCESS_TOKEN_PLACEHOLDER
    - name: DOCKER_REGISTRY_URL
      value: "localhost:32000"
    - name: DT_TENANT_URL
      value: DT_TENANT_URL_PLACEHOLDER
    - name: DT_API_TOKEN
      value: DT_API_TOKEN_PLACEHOLDER
  csrf:
    defaultCrumbIssuer:
      enabled: false
      proxyCompatability: true
  installPlugins:
    - kubernetes:1.21.2
    - kubernetes-credentials-provider:0.13
    - workflow-job:2.36
    - workflow-aggregator:2.6
    - credentials-binding:1.20
    - git:4.2.2
    - google-oauth-plugin:1.0.0
    - google-source-plugin:0.4
    - performance:3.17
    - github-branch-source:2.5.8
    - job-dsl:1.76
    - pipeline-build-step:2.7
  JCasC:
    enabled: true
    defaultConfig: false
    pluginVersion: "1.35"
    configScripts:
      jenkins-settings: |
        jenkins:
          agentProtocols:
          - "JNLP4-connect"
          - "Ping"
          authorizationStrategy:
            loggedInUsersCanDoAnything:
              allowAnonymousRead: false
          systemMessage: Welcome to the ACE BOX CI\CD server.  This Jenkins is configured and managed 'as code'.
          disableRememberMe: false
          globalNodeProperties:
          - envVars:
              env:
              - key: "DOCKER_REGISTRY_URL"
                value: ${DOCKER_REGISTRY_URL} #Load from Environment Variable
              - key: "GITHUB_USER_EMAIL"
                value: ${GITHUB_USER_EMAIL} #Load from Environment Variable
              - key: "GITHUB_ORGANIZATION"
                value: ${GITHUB_ORGANIZATION} #Load from Environment Variable
              - key: "DT_TENANT_URL"
                value: ${DT_TENANT_URL} #Load from Environment Variable
              - key: "DT_API_TOKEN"
                value: ${DT_API_TOKEN} #Load from Environment Variable
          clouds:
          - kubernetes:
              containerCapStr: "10"
              jenkinsTunnel: "jenkins-agent:50000"
              jenkinsUrl: "http://jenkins:80"
              maxRequestsPerHostStr: "32"
              name: "kubernetes"
              namespace: "cicd"
              serverUrl: "https://kubernetes.default"
              templates:
              - containers:
                - args: "^${computer.jnlpmac} ^${computer.name}"
                  envVars:
                  - envVar:
                      key: "JENKINS_URL"
                      value: "http://jenkins.default.svc.cluster.local:80"
                  image: "jenkins/jnlp-slave:3.27-1"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "jnlp"
                  resourceLimitCpu: "512m"
                  resourceLimitMemory: "512Mi"
                  resourceRequestCpu: "512m"
                  resourceRequestMemory: "512Mi"
                  workingDir: "/home/jenkins/agent"
                hostNetwork: false
                label: "jenkins-jenkins-slave "
                name: "default"
                nodeUsageMode: NORMAL
                serviceAccount: "default"
                yamlMergeStrategy: "override"
              - containers:
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "maven:3.3.9-jdk-8-alpine"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "maven"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "docker:rc"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "docker"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "lachlanevenson/k8s-kubectl:v1.12.1"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "kubectl"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "quay.io/dtacmworkshop/jmeter"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "jmeter"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "dynatraceacm/apline-curl"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "curl"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                idleMinutes: 10
                idleMinutesStr: "10"
                label: "maven"
                name: "maven-docker-k8s-jmeter"
                nodeUsageMode: NORMAL
                volumes:
                - hostPathVolume:
                    hostPath: "/var/run/docker.sock"
                    mountPath: "/var/run/docker.sock"
                - persistentVolumeClaim:
                    claimName: "maven-repo"
                    mountPath: "/root/.m2/repository"
                    readOnly: false
                yamlMergeStrategy: "override"
              - containers:
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "alpine/git"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "git"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "quay.io/dtacmworkshop/jmeter"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "jmeter"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                label: "git"
                name: "Git"
                nodeUsageMode: NORMAL
                yamlMergeStrategy: "override"
              - containers:
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "node:8"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "nodejs"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "docker:rc"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "docker"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "lachlanevenson/k8s-kubectl:v1.12.1"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "kubectl"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "dynatraceacm/apline-curl"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "curl"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                idleMinutes: 10
                idleMinutesStr: "10"
                label: "nodejs"
                name: "nodejs"
                nodeUsageMode: NORMAL
                volumes:
                - hostPathVolume:
                    hostPath: "/var/run/docker.sock"
                    mountPath: "/var/run/docker.sock"
                yamlMergeStrategy: "override"
              - containers:
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "dynatraceacm/gobuilder"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "gobuilder"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "docker:rc"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "docker"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "lachlanevenson/k8s-kubectl:v1.12.1"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "kubectl"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "quay.io/dtacmworkshop/jmeter"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "jmeter"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "dynatraceacm/apline-curl"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "curl"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                label: "golang2"
                name: "golang2"
                nodeUsageMode: NORMAL
                volumes:
                - hostPathVolume:
                    hostPath: "/var/run/docker.sock"
                    mountPath: "/var/run/docker.sock"
                yamlMergeStrategy: "override"
              - containers:
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "lachlanevenson/k8s-kubectl:v1.12.1"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "kubectl"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "alpine/git"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "git"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "quay.io/dtacmworkshop/jmeter"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "jmeter"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                - args: "cat"
                  command: "/bin/sh -c"
                  image: "dynatraceacm/apline-curl"
                  livenessProbe:
                    failureThreshold: 0
                    initialDelaySeconds: 0
                    periodSeconds: 0
                    successThreshold: 0
                    timeoutSeconds: 0
                  name: "curl"
                  ttyEnabled: true
                  workingDir: "/home/jenkins/agent"
                label: "kubegit"
                name: "kubegit"
                nodeUsageMode: NORMAL
                yamlMergeStrategy: "override"
        credentials:
          system:
            domainCredentials:
              - credentials:
                - usernamePassword:
                    username: ${GITHUB_USER_NAME} #Load from Environment Variable
                    password: ${GITHUB_PERSONAL_ACCESS_TOKEN} #Load from Environment Variable
                    description: "Github Credentials for ACE"
                    id: "git-creds-ace"
                    scope: GLOBAL
agent:
  enabled: true
  image: "odavid/jenkins-jnlp-slave"
  tag: "3.29-1-15-alpine"

persistence:
  enabled: true
  existingClaim: "jenkins-pvc"