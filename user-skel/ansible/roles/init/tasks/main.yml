---
- name: Install apt packages
  become: true
  apt:
    name: "{{ packages }}"
    state: present
    update_cache: yes
  vars:
    packages:
    - snapd
    # - parted
    - python3-jmespath
    # - ntp
    - vim
    - git

- name: "Set global Git config"
  shell: |
    git config --global user.name "dynatrace"
    git config --global user.email "ace@dynatrace.com"

# - name: Disable swap and resize disk
#   become: true
#   shell: "swapoff -a && sed -i '/swap/d' /etc/fstab && parted /dev/sda rm 2 && growpart /dev/sda 1 && resize2fs /dev/sda1"
#   args:
#     removes: /dev/sda2

# - name: Install snap core
#   become: true
#   command: snap install core


# - name: iptables - Allow forwarding
#   become: true
#   shell: iptables -P FORWARD ACCEPT

# - name: Install iptables-persistent
#   apt:
#     name: "{{ packages }}"
#     state: present
#     update_cache: yes
#   vars:
#     packages:
#     - iptables-persistent
