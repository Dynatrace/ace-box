- name: Ensure the easytrade namespace exists
  kubernetes.core.k8s:
    kind: Namespace
    api_version: v1
    name: "{{ easytrade_namespace }}"
    state: present

- name: Kustomize Build
  set_fact:
    resources: "{{ lookup('kubernetes.core.kustomize', dir=local_easytrade_folder_path }}"

- name: Kustomize Apply
  k8s:
    definition: "{{ lookup('kubernetes.core.kustomize', dir=local_easytrade_folder_path }}"
    state: present